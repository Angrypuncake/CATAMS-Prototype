<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Cancellation Request</title>
  <style>
    :root{
      --bg:#f5f7fb; --card:#fff; --line:#e5e7eb; --muted:#6b7280; --text:#0f172a; --brand:#2563eb; --warn:#f59e0b;
    }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);font:16px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
    .page{max-width:960px;margin:26px auto;padding:0 16px}
    .card{background:var(--card);border:1px solid var(--line);border-radius:14px;box-shadow:0 2px 10px rgba(0,0,0,.04)}
    .shell{padding:20px}
    h1{margin:0 0 6px;font-size:1.6rem}
    .sub{color:var(--muted);margin:0 0 18px}
    a.back{color:var(--brand);text-decoration:none}

    /* Summary */
    .summary{display:grid;gap:10px;background:#fafafa;border:1px solid var(--line);border-radius:12px;padding:14px;margin-bottom:18px}
    .summary .top{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    .badge{display:inline-flex;align-items:center;gap:6px;padding:3px 10px;border-radius:999px;border:1px solid var(--line);font-size:12px;background:#fff7ed;color:#92400e}

    .grid{display:grid;grid-template-columns:140px 1fr;column-gap:8px;row-gap:6px}
    .label{color:var(--muted)}

    .cols{display:grid;gap:16px}
    @media(min-width:900px){.cols{grid-template-columns:1fr 1fr}}

    .section-title{font-weight:700;margin:10px 0 8px}
    .box{border:1px solid var(--line);border-radius:12px;padding:12px;background:#fff}
    .row{display:grid;grid-template-columns:170px 1fr;align-items:center;gap:10px;margin:10px 0}

    input[type="text"],input[type="time"],input[type="date"],input[type="number"],select,textarea{width:100%;padding:10px;border:1px solid var(--line);border-radius:10px}
    textarea{min-height:96px;resize:vertical}
    .hint{font-size:12px;color:var(--muted)}

    .radio{display:flex;gap:14px;flex-wrap:wrap}
    .chips{display:flex;flex-wrap:wrap;gap:8px;margin-top:8px}
    .chip{font-size:12px;border:1px solid var(--line);padding:5px 10px;border-radius:999px;background:#f3f4f6}

    .actions{display:flex;justify-content:flex-end;gap:10px;margin-top:14px}
    .btn{appearance:none;border:1px solid var(--line);background:#fff;color:#334155;padding:10px 14px;border-radius:10px;cursor:pointer}
    .btn.primary{background:#111827;color:#fff;border-color:#111827}
    .btn:disabled{opacity:.55;cursor:not-allowed}

    .search-results{border:1px solid var(--line);border-radius:10px;background:#fff;margin-top:6px;display:none}
    .search-results div{padding:8px 10px;cursor:pointer}
    .search-results div:hover{background:#f9fafb}

    .ack{display:flex;gap:10px;align-items:flex-start}
  </style>
</head>
<body>
  <div class="page">
    <div class="card shell">
      <div style="display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap">
        <div>
          <h1>Cancellation Request</h1>
          <p class="sub">Use this when you cannot attend the allocated session. You may suggest a replacement or ask the coordinator to reassign.</p>
        </div>
        <a class="back" href="#">← Back to Allocation</a>
      </div>

      <!-- Allocation Summary -->
      <div class="summary">
        <div class="top">
          <strong>INFO1110 – Programming Fundamentals</strong>
          <span class="badge">Time‑critical</span>
        </div>
        <div class="grid">
          <div class="label">Date:</div><div>12/09/2025</div>
          <div class="label">Time:</div><div>09:00 – 11:00</div>
          <div class="label">Location:</div><div>Room A</div>
          <div class="label">Hours:</div><div>2h</div>
          <div class="label">Session:</div><div>Tutorial</div>
        </div>
      </div>

      <div class="cols">
        <!-- Cancellation details -->
        <div>
          <div class="section-title">Cancellation Details</div>
          <div class="box">
            <div class="row">
              <div class="label">Reason</div>
              <div>
                <textarea id="reason" placeholder="Briefly explain why you cannot attend (required)"></textarea>
                <div class="hint">Examples: illness, exam clash, unexpected work/placement, personal emergency.</div>
              </div>
            </div>
            <div class="row">
              <div class="label">Attachment</div>
              <div><input type="file" id="attach"> <div class="hint">Optional evidence (PDF/PNG/DOC up to 5MB).</div></div>
            </div>
            <div class="row">
              <div class="label">Replacement Options</div>
              <div class="radio">
                <label><input type="radio" name="rep" value="suggest" id="repSuggest"> I will suggest a tutor</label>
                <label><input type="radio" name="rep" value="coord" id="repCoord" checked> Ask coordinator to assign</label>
              </div>
            </div>
            <div id="searchWrap" style="display:none">
              <div class="row">
                <div class="label">Find Tutor</div>
                <div>
                  <input type="text" id="tutorSearch" placeholder="Type a name or email…">
                  <div class="search-results" id="results"></div>
                  <div class="hint">Search eligible tutors in this unit. Selecting fills the field.</div>
                </div>
              </div>
            </div>
            <div class="row">
              <div class="label">Timing</div>
              <div>
                <select id="timing">
                  <option value="gt48">More than 48 hours before session</option>
                  <option value="lt48">Within 48 hours of session (urgent)</option>
                  <option value="lt24">Within 24 hours of session (critical)</option>
                </select>
                <div class="hint">Used to prioritise escalation and notifications.</div>
              </div>
            </div>
            <div class="row">
              <div class="label">Acknowledgement</div>
              <div class="ack">
                <input type="checkbox" id="ack"> <label for="ack">I understand this cancellation may leave the session unassigned and the coordinator may contact me for clarification.</label>
              </div>
            </div>
          </div>
        </div>

        <!-- Impact preview / routing -->
        <div>
          <div class="section-title">Impact Preview</div>
          <div class="box">
            <div class="chips" id="chips">
              <div class="chip">Route: Coordinator</div>
              <div class="chip" id="chipUrgency">Urgency: Standard</div>
              <div class="chip">Budget effect: neutral</div>
              <div class="chip">Notifications: TA + Coordinator</div>
            </div>
            <div class="section-title" style="margin-top:14px">Notes</div>
            <div class="hint">If you suggest a tutor, they will be asked to confirm before the coordinator approves.</div>
          </div>
        </div>
      </div>

      <div class="actions">
        <button class="btn" type="button">Cancel</button>
        <button class="btn" type="button">Save Draft</button>
        <button class="btn primary" id="submitBtn" type="button" disabled>Submit Cancellation Request</button>
      </div>
    </div>
  </div>

  <script>
    // Toggle search when suggesting a replacement
    const repSuggest = document.getElementById('repSuggest');
    const repCoord = document.getElementById('repCoord');
    const searchWrap = document.getElementById('searchWrap');
    const reason = document.getElementById('reason');
    const ack = document.getElementById('ack');
    const submitBtn = document.getElementById('submitBtn');
    const timing = document.getElementById('timing');
    const chipUrgency = document.getElementById('chipUrgency');

    repSuggest.addEventListener('change',()=>{ if(repSuggest.checked){ searchWrap.style.display='block'; } });
    repCoord.addEventListener('change',()=>{ if(repCoord.checked){ searchWrap.style.display='none'; } });

    function validate(){
      const ok = reason.value.trim().length >= 5 && ack.checked;
      submitBtn.disabled = !ok;
    }
    reason.addEventListener('input', validate);
    ack.addEventListener('change', validate);
    validate();

    // Urgency chip update
    timing.addEventListener('change', ()=>{
      const map = { gt48:'Urgency: Standard', lt48:'Urgency: High (48h)', lt24:'Urgency: Critical (24h)' };
      chipUrgency.textContent = map[timing.value];
    });

    // Simple front-end search mock
    const tutors = [
      'Alex Smith – INFO1110 – alex.smith@sydney.edu.au',
      'Sarah Tan – INFO1110 – sarah.tan@sydney.edu.au',
      'James Wu – INFO1910 – james.wu@sydney.edu.au',
      'Emma Zhou – INFO1110 – emma.zhou@sydney.edu.au'
    ];
    const input = document.getElementById('tutorSearch');
    const results = document.getElementById('results');
    if(input){
      input.addEventListener('input', ()=>{
        const q = (input.value||'').toLowerCase();
        results.innerHTML = '';
        if(!q){ results.style.display='none'; return; }
        const matches = tutors.filter(t=> t.toLowerCase().includes(q) && t.includes('INFO1110'));
        if(matches.length===0){ results.innerHTML = '<div>No tutors found</div>'; }
        else{
          matches.forEach(m => {
            const div = document.createElement('div');
            div.textContent = m;
            div.addEventListener('click', ()=>{ input.value = m; results.style.display='none'; });
            results.appendChild(div);
          });
        }
        results.style.display='block';
      });
    }
  </script>
</body>
</html>
