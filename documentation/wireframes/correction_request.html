<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Correction Request</title>
  <style>
    :root{
      --bg:#f5f7fb; --card:#fff; --line:#e5e7eb; --muted:#6b7280; --text:#0f172a;
      --brand:#2563eb; --ok:#16a34a; --warn:#f59e0b; --danger:#dc2626;
    }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);font:16px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
    .page{max-width:1000px;margin:26px auto;padding:0 16px}
    .card{background:var(--card);border:1px solid var(--line);border-radius:14px;box-shadow:0 2px 10px rgba(0,0,0,.04)}
    .shell{padding:20px}
    h1{margin:0 0 6px;font-size:1.6rem}
    .sub{color:var(--muted);margin:0 0 18px}
    a.back{color:var(--brand);text-decoration:none}

    /* Summary */
    .summary{display:grid;gap:10px;background:#fafafa;border:1px solid var(--line);border-radius:12px;padding:14px;margin-bottom:18px}
    .summary .top{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    .badge{display:inline-flex;align-items:center;gap:6px;padding:3px 10px;border-radius:999px;border:1px solid var(--line);font-size:12px}
    .badge.ok{background:#ecfdf5;color:#065f46}
    .badge.ok::before{content:"";width:8px;height:8px;border-radius:999px;background:var(--ok)}
    .grid{display:grid;grid-template-columns:140px 1fr;column-gap:8px;row-gap:6px}
    .label{color:var(--muted)}

    /* Two columns */
    .cols{display:grid;gap:16px}
    @media(min-width:900px){.cols{grid-template-columns:1fr 1fr}}

    .section-title{font-weight:700;margin:10px 0 8px}
    .box{border:1px solid var(--line);border-radius:12px;padding:12px;background:#fff}
    .box.muted{background:#fbfbfc}
    .row{display:grid;grid-template-columns:150px 1fr;align-items:center;gap:10px;margin:10px 0}
    .row .toggle{display:flex;align-items:center;gap:8px}

    input[type="text"],input[type="time"],input[type="date"],input[type="number"],select,textarea{width:100%;padding:10px;border:1px solid var(--line);border-radius:10px}
    textarea{min-height:96px;resize:vertical}
    .hint{font-size:12px;color:var(--muted)}

    .changed{border-color:#f59e0b;background:#fff8eb}

    /* Chips & footer */
    .chips{display:flex;flex-wrap:wrap;gap:8px;margin-top:8px}
    .chip{font-size:12px;border:1px solid var(--line);padding:5px 10px;border-radius:999px;background:#f3f4f6}

    .actions{display:flex;justify-content:flex-end;gap:10px;margin-top:14px}
    .btn{appearance:none;border:1px solid var(--line);background:#fff;color:#334155;padding:10px 14px;border-radius:10px;cursor:pointer}
    .btn.primary{background:#111827;color:#fff;border-color:#111827}
    .btn:disabled{opacity:.55;cursor:not-allowed}

    .error{color:var(--danger);font-size:12px;margin-top:6px;display:none}
  </style>
</head>
<body>
  <div class="page">
    <div class="card shell">
      <div style="display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap">
        <div>
          <h1>Correction Request</h1>
          <p class="sub">Use this when allocation details are incorrect (date, time, location, hours, or session type).</p>
        </div>
        <a class="back" href="#">← Back to Allocation</a>
      </div>

      <!-- Allocation Summary -->
      <div class="summary">
        <div class="top">
          <strong>INFO1110 – Programming Fundamentals</strong>
          <span class="badge ok">Confirmed</span>
        </div>
        <div class="grid">
          <div class="label">Date:</div><div id="sysDateText">12/09/2025</div>
          <div class="label">Time:</div><div id="sysTimeText">09:00 – 11:00</div>
          <div class="label">Location:</div><div id="sysLocText">Room A</div>
          <div class="label">Hours:</div><div id="sysHoursText">2.0h</div>
          <div class="label">Session:</div><div id="sysSessText">Tutorial</div>
        </div>
      </div>

      <div class="cols">
        <!-- System Record (read only) -->
        <div>
          <div class="section-title">System Record</div>
          <div class="box muted">
            <div class="row"><div class="label">Date</div><div>2025-09-12</div></div>
            <div class="row"><div class="label">Start / End</div><div>09:00 — 11:00</div></div>
            <div class="row"><div class="label">Location</div><div>Room A</div></div>
            <div class="row"><div class="label">Hours</div><div>2.0</div></div>
            <div class="row"><div class="label">Session</div><div>Tutorial</div></div>
            <div class="hint">Snapshot of current allocation (immutable).</div>
          </div>
        </div>

        <!-- Proposed Correction (editable) -->
        <div>
          <div class="section-title">Proposed Correction</div>
          <div class="box" id="editBox">
            <div class="row">
              <div class="toggle"><input type="checkbox" id="cDate"> <label for="cDate">Date</label></div>
              <div><input type="date" id="date" value="2025-09-12" disabled></div>
            </div>
            <div class="row">
              <div class="toggle"><input type="checkbox" id="cTime"> <label for="cTime">Start / End</label></div>
              <div style="display:flex;gap:8px"><input type="time" id="start" value="09:00" disabled><input type="time" id="end" value="11:00" disabled></div>
            </div>
            <div class="row">
              <div class="toggle"><input type="checkbox" id="cLoc"> <label for="cLoc">Location</label></div>
              <div><input type="text" id="location" value="Room A" disabled></div>
            </div>
            <div class="row">
              <div class="toggle"><input type="checkbox" id="cHours"> <label for="cHours">Hours</label></div>
              <div><input type="number" step="0.5" min="0" id="hours" value="2.0" disabled></div>
            </div>
            <div class="row">
              <div class="toggle"><input type="checkbox" id="cSess"> <label for="cSess">Session</label></div>
              <div>
                <select id="session" disabled>
                  <option>Tutorial</option>
                  <option>Lab</option>
                  <option>Workshop</option>
                  <option>Consultation</option>
                </select>
              </div>
            </div>
            <div class="row" style="align-items:start">
              <div class="label">Justification</div>
              <div>
                <textarea id="reason" placeholder="Explain why the record is incorrect or what changed (required when you modify any field)"></textarea>
                <div class="hint">Examples: room change from timetabling; session overran for assignment Q&A; timetable conflict discovered.</div>
                <div class="error" id="reasonErr">Please provide a brief justification (min 5 characters).</div>
              </div>
            </div>
            <div class="row">
              <div class="label">Attachment</div>
              <div><input type="file" id="attach"> <div class="hint">Optional evidence (PDF/PNG/DOC up to 5MB).</div></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Review chips -->
      <div class="section-title">Review Summary</div>
      <div class="chips">
        <div class="chip" id="chipChanges">No changes selected</div>
        <div class="chip">Route: Coordinator</div>
        <div class="chip">ETA: 1–2 business days</div>
      </div>

      <div class="actions">
        <button class="btn" type="button">Cancel</button>
        <button class="btn" type="button">Save Draft</button>
        <button class="btn primary" id="submitBtn" type="button" disabled>Submit Correction Request</button>
      </div>
    </div>
  </div>

  <script>
    // Baseline system values
    const sys = { date:'2025-09-12', start:'09:00', end:'11:00', location:'Room A', hours:'2.0', session:'Tutorial' };

    const els = {
      cDate:document.getElementById('cDate'), cTime:document.getElementById('cTime'), cLoc:document.getElementById('cLoc'), cHours:document.getElementById('cHours'), cSess:document.getElementById('cSess'),
      date:document.getElementById('date'), start:document.getElementById('start'), end:document.getElementById('end'), location:document.getElementById('location'), hours:document.getElementById('hours'), session:document.getElementById('session'),
      reason:document.getElementById('reason'), reasonErr:document.getElementById('reasonErr'),
      chipChanges:document.getElementById('chipChanges'), submitBtn:document.getElementById('submitBtn'), editBox:document.getElementById('editBox')
    };

    const toggles = [
      ['cDate','date'],
      ['cTime','start','end'],
      ['cLoc','location'],
      ['cHours','hours'],
      ['cSess','session']
    ];

    toggles.forEach(ids=>{
      const c = els[ids[0]]; const inputs = ids.slice(1).map(id=>els[id]);
      c.addEventListener('change',()=>{ inputs.forEach(i=>i.disabled=!c.checked); update(); });
      inputs.forEach(i=> i.addEventListener('input', update));
    });

    els.reason.addEventListener('input', update);
    update();

    function update(){
      const changes = [];
      // Clear change styling
      Array.from(els.editBox.querySelectorAll('input, select')).forEach(i=> i.classList.remove('changed'));

      if(els.cDate.checked && els.date.value !== sys.date){ changes.push(`Date ${sys.date} → ${els.date.value}`); els.date.classList.add('changed'); }
      if(els.cTime.checked && (els.start.value !== sys.start || els.end.value !== sys.end)){
        changes.push(`Time ${sys.start}–${sys.end} → ${els.start.value}–${els.end.value}`);
        els.start.classList.add('changed'); els.end.classList.add('changed');
      }
      if(els.cLoc.checked && els.location.value.trim() !== sys.location){ changes.push(`Location ${sys.location} → ${els.location.value.trim()}`); els.location.classList.add('changed'); }
      const hoursStr = (Number(els.hours.value||0)).toFixed(1);
      if(els.cHours.checked && hoursStr !== Number(sys.hours).toFixed(1)){ changes.push(`Hours ${Number(sys.hours).toFixed(1)} → ${hoursStr}`); els.hours.classList.add('changed'); }
      if(els.cSess.checked && els.session.value !== sys.session){ changes.push(`Session ${sys.session} → ${els.session.value}`); els.session.classList.add('changed'); }

      els.chipChanges.textContent = changes.length ? `${changes.length} change(s): ${changes.join(' • ')}` : 'No changes selected';

      const reasonOk = els.reason.value.trim().length >= 5 || changes.length === 0; // only require when changes exist
      els.reasonErr.style.display = (changes.length > 0 && !reasonOk) ? 'block' : 'none';

      els.submitBtn.disabled = !(changes.length > 0 && reasonOk);
    }
  </script>
</body>
</html>
